<UserControl x:Class="Sh.Autofit.New.PartsMappingUI.Views.VehicleDiscoveryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="700" d:DesignWidth="1200">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="20">
            <TextBlock Text="×’×™×œ×•×™ ×¨×›×‘×™× ×—×“×©×™× ×ž×ž××’×¨ ×”×ž×ž×©×œ×”"
                      FontSize="24" FontWeight="Bold" Foreground="White"
                      HorizontalAlignment="Right"/>
        </Border>

        <!-- Discovery Controls -->
        <Border Grid.Row="1" Background="White" Padding="20" BorderBrush="#BDC3C7" BorderThickness="0,0,0,1">
            <StackPanel>
                <Button Content="ðŸ” ×’×œ×” ×¨×›×‘×™× ×—×“×©×™×"
                       Command="{Binding DiscoverNewVehiclesCommand}"
                       IsEnabled="{Binding IsDiscovering, Converter={StaticResource InverseBoolConverter}}"
                       Background="#3498DB" Foreground="White"
                       FontSize="16" FontWeight="Bold"
                       Padding="20,10" Margin="0,0,0,10"
                       HorizontalAlignment="Right"/>

                <ProgressBar Height="30"
                            Minimum="0"
                            Maximum="{Binding ProgressTotal}"
                            Value="{Binding ProgressCurrent}"
                            Visibility="{Binding IsDiscovering, Converter={StaticResource BoolToVisConverter}}"/>

                <TextBlock Text="{Binding StatusMessage}"
                          FontSize="14" Margin="0,10,0,0"
                          Foreground="#34495E"
                          HorizontalAlignment="Right"/>
            </StackPanel>
        </Border>

        <!-- Selection Controls -->
        <Border Grid.Row="2" Background="#ECF0F1" Padding="15"
               Visibility="{Binding HasPendingVehicles, Converter={StaticResource BoolToVisConverter}}">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <TextBlock Text="{Binding ApprovedCount, StringFormat='{}{0} × ×‘×—×¨×•'}"
                          FontSize="14" FontWeight="Bold"
                          VerticalAlignment="Center" Margin="0,0,20,0"/>

                <Button Content="âœ“ ××©×¨ × ×‘×—×¨×™×"
                       Command="{Binding ApproveSelectedCommand}"
                       Background="#27AE60" Foreground="White"
                       Padding="15,5" Margin="0,0,10,0"/>

                <Button Content="âœ— ×“×—×” × ×‘×—×¨×™×"
                       Command="{Binding RejectSelectedCommand}"
                       Background="#E74C3C" Foreground="White"
                       Padding="15,5" Margin="0,0,10,0"/>

                <Button Content="×‘×—×¨ ×”×›×œ"
                       Command="{Binding SelectAllCommand}"
                       Padding="15,5" Margin="0,0,10,0"/>

                <Button Content="×‘×˜×œ ×‘×—×™×¨×”"
                       Command="{Binding DeselectAllCommand}"
                       Padding="15,5" Margin="0,0,20,0"/>

                <Button Content="âš™ï¸ ×¢×‘×“ ×¨×›×‘×™× ×ž××•×©×¨×™×"
                       Command="{Binding ProcessApprovedVehiclesCommand}"
                       IsEnabled="{Binding IsProcessing, Converter={StaticResource InverseBoolConverter}}"
                       Background="#9B59B6" Foreground="White"
                       FontWeight="Bold"
                       Padding="20,5"/>
            </StackPanel>
        </Border>

        <!-- Pending Vehicles Grid -->
        <DataGrid Grid.Row="3"
                 ItemsSource="{Binding PendingVehicles}"
                 AutoGenerateColumns="False"
                 CanUserAddRows="False"
                 CanUserDeleteRows="False"
                 SelectionMode="Extended"
                 IsReadOnly="False"
                 Margin="10">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header="×‘×—×¨"
                                       Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}"
                                       Width="50"/>

                <DataGridTextColumn Header="×™×¦×¨×Ÿ"
                                   Binding="{Binding ManufacturerName}"
                                   Width="120"/>

                <DataGridTextColumn Header="×“×’×"
                                   Binding="{Binding ModelName}"
                                   Width="150"/>

                <DataGridTextColumn Header="×©× ×ž×¡×—×¨×™"
                                   Binding="{Binding CommercialName}"
                                   Width="120"/>

                <DataGridTextColumn Header="×©× ×”"
                                   Binding="{Binding ManufacturingYear}"
                                   Width="70"/>

                <DataGridTextColumn Header="×ž×¤×¨×˜"
                                   Binding="{Binding Specs}"
                                   Width="*"/>

                <DataGridTextColumn Header="×§×•×“ ×™×¦×¨×Ÿ"
                                   Binding="{Binding ManufacturerCode}"
                                   Width="90"/>

                <DataGridTextColumn Header="×§×•×“ ×“×’×"
                                   Binding="{Binding ModelCode}"
                                   Width="90"/>

                <DataGridTextColumn Header="×”×ª×’×œ×” ×‘"
                                   Binding="{Binding DiscoveredAt, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}"
                                   Width="140"/>
            </DataGrid.Columns>

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsSelected}" Value="True">
                            <Setter Property="Background" Value="#D5F4E6"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>

        <!-- Empty State -->
        <Border Grid.Row="3"
               Visibility="{Binding HasPendingVehicles, Converter={StaticResource InverseBoolToVisConverter}}"
               Background="#ECF0F1">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="ðŸ”" FontSize="72" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                <TextBlock Text="××™×Ÿ ×¨×›×‘×™× ×ž×ž×ª×™× ×™× ×œ×‘×“×™×§×”"
                          FontSize="20" FontWeight="Bold"
                          Foreground="#7F8C8D"
                          HorizontalAlignment="Center" Margin="0,0,0,10"/>
                <TextBlock Text="×œ×—×¥ ×¢×œ '×’×œ×” ×¨×›×‘×™× ×—×“×©×™×' ×›×“×™ ×œ×”×ª×—×™×œ"
                          FontSize="14" Foreground="#95A5A6"
                          HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>

        <!-- Footer -->
        <Border Grid.Row="4" Background="#34495E" Padding="15">
            <TextBlock HorizontalAlignment="Center" Foreground="White">
                <Run Text="×¡×”×´×› ×¨×›×‘×™× ×—×“×©×™× ×©× ×ž×¦××•:"/>
                <Run Text="{Binding NewVehiclesFound}" FontWeight="Bold"/>
                <Run Text=" | "/>
                <Run Text="×ž×ž×ª×™× ×™× ×œ××™×©×•×¨:"/>
                <Run Text="{Binding PendingVehicles.Count}" FontWeight="Bold"/>
            </TextBlock>
        </Border>
    </Grid>
</UserControl>
