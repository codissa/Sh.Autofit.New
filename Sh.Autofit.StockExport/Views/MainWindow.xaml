<Window x:Class="Sh.Autofit.StockExport.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Sh.Autofit.StockExport.Views"
        mc:Ignorable="d"
        Title="ייצוא מלאי - מחולל אקסל WizCount/H-ERP"
        Height="500" Width="650"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanMinimize"
        Background="#F5F5F5">

    <Window.Resources>
        <!-- Converters -->
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <local:InverseBooleanConverter x:Key="InverseBooleanConverter"/>

        <!-- Style for Labels -->
        <Style TargetType="Label">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
        </Style>

        <!-- Style for TextBoxes -->
        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#007ACC"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style for ComboBox -->
        <Style TargetType="ComboBox">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Style for Buttons -->
        <Style TargetType="Button">
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Background" Value="#007ACC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#005A9E"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#CCCCCC"/>
                    <Setter Property="Foreground" Value="#666666"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style for Browse Button -->
        <Style x:Key="BrowseButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#28A745"/>
            <Setter Property="Padding" Value="20,8"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#218838"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style for Export Button -->
        <Style x:Key="ExportButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#DC3545"/>
            <Setter Property="Padding" Value="30,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#C82333"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="30" FlowDirection="RightToLeft">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="30"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Grid.Row="0"
                   Text="ייצוא תנועות מלאי לאקסל WizCount/H-ERP"
                   FontSize="18"
                   FontWeight="Bold"
                   Foreground="#333333"
                   HorizontalAlignment="Center"/>

        <!-- Stock ID -->
        <Grid Grid.Row="2" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Content="מספר מזהה:"/>
            <TextBox Grid.Column="1"
                     Text="{Binding StockId, UpdateSourceTrigger=PropertyChanged}"
                     FlowDirection="LeftToRight"
                     ToolTip="הזן את מספר המזהה לשאילתה ממסד הנתונים"/>
        </Grid>

        <!-- Document Type -->
        <Grid Grid.Row="3" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Content="סוג מסמך:"/>
            <ComboBox Grid.Column="1"
                      ItemsSource="{Binding DocumentTypes}"
                      SelectedItem="{Binding SelectedDocumentType}"
                      DisplayMemberPath="DisplayName"
                      ToolTip="בחר את סוג המסמך"/>
        </Grid>

        <!-- Description -->
        <Grid Grid.Row="4" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Content="מפתח חשבון:"/>
            <TextBox Grid.Column="1"
                     Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}"
                     ToolTip="הזן את מפתח החשבון"/>
        </Grid>

        <!-- Document Number -->
        <Grid Grid.Row="5" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Content="מספר אסמכתא:"/>
            <TextBox Grid.Column="1"
                     Text="{Binding DocNumber, UpdateSourceTrigger=PropertyChanged}"
                     FlowDirection="LeftToRight"
                     ToolTip="הזן את מספר האסמכתא"/>
            <Button Grid.Column="2"
                    Content="רענן"
                    Command="{Binding RefreshDocNumberCommand}"
                    Margin="10,0,0,0"
                    ToolTip="טען מחדש את מספר האסמכתא הנוכחי מהמסד"/>
        </Grid>

        <!-- Save Path -->
        <Grid Grid.Row="6" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="180"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" Content="נתיב שמירה:"/>
            <TextBox Grid.Column="1"
                     Text="{Binding SavePath, UpdateSourceTrigger=PropertyChanged}"
                     IsReadOnly="True"
                     Background="#F9F9F9"
                     FlowDirection="LeftToRight"
                     ToolTip="לחץ על עיון לבחירת מיקום שמירת הקובץ"/>
            <Button Grid.Column="2"
                    Content="עיון..."
                    Command="{Binding BrowseCommand}"
                    Style="{StaticResource BrowseButtonStyle}"
                    Margin="10,0,0,0"/>
        </Grid>

        <!-- Export Button -->
        <Button Grid.Row="8"
                Content="ייצא לאקסל"
                Command="{Binding ExportCommand}"
                Style="{StaticResource ExportButtonStyle}"
                HorizontalAlignment="Center"
                IsEnabled="{Binding IsExporting, Converter={StaticResource InverseBooleanConverter}}"/>

        <!-- Progress Indicator -->
        <StackPanel Grid.Row="9"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Visibility="{Binding IsExporting, Converter={StaticResource BoolToVis}}">
            <ProgressBar Width="200"
                         Height="20"
                         IsIndeterminate="True"
                         Margin="0,0,10,0"/>
            <TextBlock Text="מייצא..."
                       VerticalAlignment="Center"
                       FontSize="13"
                       Foreground="#666666"/>
        </StackPanel>

        <!-- Status Bar -->
        <Border Grid.Row="10"
                Background="#E8E8E8"
                BorderBrush="#CCCCCC"
                BorderThickness="1"
                CornerRadius="3"
                Padding="10,8"
                Margin="0,10,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0"
                           Text="סטטוס: "
                           FontWeight="SemiBold"
                           FontSize="12"
                           Foreground="#333333"/>
                <TextBlock Grid.Column="1"
                           Text="{Binding StatusMessage}"
                           FontSize="12"
                           Foreground="#555555"
                           TextTrimming="CharacterEllipsis"/>
            </Grid>
        </Border>
    </Grid>
</Window>
